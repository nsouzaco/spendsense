# AI Summary Feature

## Overview
The "âœ¨ Generate My Summary" button provides users with a personalized financial summary generated by AI, based on their existing financial data.

## Key Design Decision
**Personas, signals, and recommendations are generated during deployment/seeding** - they are NOT recalculated when the user clicks the button.

The button **ONLY generates AI text content** - a personalized narrative summary.

## How It Works

### 1. Data Collection
The endpoint `/api/users/[userId]/summary` reads existing data:
- User profile
- Accounts (balances, credit cards, limits)
- Transactions (recent activity)
- Signals (180-day window)
- Personas (primary financial profile)
- Recommendations (active count)

### 2. AI Generation
The system sends this context to OpenAI GPT-4 with instructions to create:
- **3-4 short paragraphs**
- **Warm, supportive tone**
- **Personalized insights** based on their specific numbers
- **No jargon** or financial buzzwords
- **Actionable encouragement**

### 3. Display
The summary is displayed in a clean card with:
- Purple accent design
- "Powered by AI" badge
- Refresh button to regenerate
- Quick recommendations list below

## What is NOT AI-Generated

âœ… **Rule-Based (Pre-Calculated)**:
- Signal detection (credit utilization, savings patterns, etc.)
- Persona assignment (HIGH_UTILIZATION, SAVINGS_BUILDER, etc.)
- Recommendation templates and titles
- Rationales and action items
- Partner offers matching
- Guardrails (consent, eligibility, tone)

ðŸ¤– **AI-Generated (On-Demand)**:
- User's personalized financial summary (this feature)
- Educational content in recommendations (generated during seeding)

## API Endpoint

### POST `/api/users/[userId]/summary`

**Request**: No body required

**Response**:
```json
{
  "success": true,
  "data": {
    "summary": "Hello there!\n\nI'm thrilled to have the opportunity...",
    "generatedAt": "2025-11-06T22:19:17.544Z"
  }
}
```

**Timing**: 2-5 seconds (waiting for OpenAI API)

**Fallback**: If OpenAI fails, shows a generic error message

## User Experience

### Before Summary Generation
- Shows empty state with lightbulb icon
- "Get Your AI Financial Summary" heading
- Button: "âœ¨ Generate My Summary"

### During Generation
- Progress bar animation
- Button text: "Generating... Please wait"
- Button disabled

### After Generation
- Summary displayed in formatted card
- Refresh button available
- Quick recommendations shown below
- Can regenerate anytime

## Performance

| Metric | Value |
|--------|-------|
| Latency | 2-5 seconds |
| API Calls | 1 (OpenAI only) |
| Data Queries | 6 (user, accounts, transactions, signals, personas, recommendations) |
| Cache | None (regenerated each time) |

## Benefits of This Approach

1. **Separation of Concerns**: Data processing vs content generation
2. **Performance**: No expensive signal/persona recalculation
3. **Simplicity**: Single-purpose endpoint
4. **User Control**: Can refresh summary without reprocessing data
5. **Cost-Effective**: Only calls OpenAI when user explicitly requests
6. **Scalability**: Lightweight endpoint that scales well

## Future Enhancements

- [ ] Cache summaries for 24 hours
- [ ] Add "Share" functionality
- [ ] Export summary as PDF
- [ ] Multi-language support
- [ ] Voice narration option

